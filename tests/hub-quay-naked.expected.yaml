---
# Source: quay/templates/rbac/quay-admin-sa.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: quay-admin-sa
  namespace: quay-enterprise
  annotations:
    argocd.argoproj.io/sync-wave: "1"
---
# Source: quay/templates/secret/secret.yaml
apiVersion: v1
kind: Secret
metadata:
  name: quay-init-config-bundle-secret
  namespace: quay-enterprise
  annotations:
    argocd.argoproj.io/sync-wave: "4"
type: Opaque
stringData:
  config.yaml: |
    FEATURE_USER_INITIALIZE: true
    BROWSER_API_CALLS_XHR_ONLY: false
    SUPER_USERS:
    - quayadmin
    FEATURE_USER_CREATION: true
    ALLOW_PULLS_WITHOUT_STRICT_LOGGING: false
    AUTHENTICATION_TYPE: Database
    DEFAULT_TAG_EXPIRATION: 2w
    ENTERPRISE_LOGO_URL: /static/img/RH_Logo_Quay_Black_UX-
    FEATURE_BUILD_SUPPORT: false
    FEATURE_DIRECT_LOGIN: true
    FEATURE_MAILING: false
    REGISTRY_TITLE: Red Hat Quay
    REGISTRY_TITLE_SHORT: Quay
    TEAM_RESYNC_STALE_TIME: 60m
    TESTING: false
---
# Source: quay/templates/rbac/quay-admin-role.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  annotations:
    argocd.argoproj.io/sync-wave: "1"
  name: quay-admin-role
rules:
  - apiGroups:
      - "apps/v1"
    resources:
      - deployment
    verbs:
      - get
      - list
      - patch
      - update
---
# Source: quay/templates/rbac/quay-admin-rolebinding.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: quay-admin-binding
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: quay-admin-role
subjects:
  - kind: ServiceAccount
    name: quay-admin-sa
    namespace: quay-enterprise
---
# Source: quay/templates/quayRegistry/job-noobaa-wait.yaml
apiVersion: batch/v1
kind: Job
metadata:
  annotations:
    argocd.argoproj.io/hook: Sync
    argocd.argoproj.io/sync-wave: "-5"
  name: wait-for-noobaa-deployment
  namespace: openshift-gitops
spec:
  template:
    spec:
      containers: 
      - image: image-registry.openshift-image-registry.svc:5000/openshift/cli:latest
        command:
        - /bin/bash
        - -c
        - |
          oc wait --for=condition=available deploy/noobaa-endpoint -n openshift-storage --timeout=900s
        name: noobaa-deployment-pause
      dnsPolicy: ClusterFirst
      activeDeadlineSeconds: 900
      restartPolicy: Never
      serviceAccount: openshift-gitops-argocd-application-controller
      serviceAccountName: openshift-gitops-argocd-application-controller
      terminationGracePeriodSeconds: 60
---
# Source: quay/templates/bridge/quay-integration.yaml
apiVersion: quay.redhat.com/v1
kind: QuayIntegration
metadata:
 name: quay
 annotations:
   argocd.argoproj.io/sync-wave: "7"
spec:
 clusterID: openshift
 credentialsSecret:
   name: quay-integration
   namespace: openshift-operators
 insecureRegistry: false
 quayHostname: https://quay-registry-quay-quay-enterprise.apps.NAME.DOMAIN
---
# Source: quay/templates/quayRegistry/registry.yaml
apiVersion: quay.redhat.com/v1
kind: QuayRegistry
metadata:
  name: quay-registry
  namespace: quay-enterprise
  annotations:
    argocd.argoproj.io/sync-wave: "4"
spec:
  components:
    - kind: clair
      managed: true
    - kind: horizontalpodautoscaler
      managed: true
    - kind: mirror
      managed: true
    - kind: monitoring
      managed: true
    - kind: postgres
      managed: true
    - kind: redis
      managed: true
    - kind: objectstorage
      managed: true
    - kind: route
      managed: true
    - kind: tls
      managed: true
  configBundleSecret: quay-init-config-bundle-secret
